<!doctype html>
<html lang="zh-CN" data-theme="auto">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>教育学学术导航</title>
    <meta name="description" content="教育学相关的学术网站与资源导航，支持搜索、标签筛选、深浅色主题、本地导入导出数据。" />
    <link rel="stylesheet" href="css/styles.css" />
    <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ctext y='0.9em' font-size='90'%3E🎓%3C/text%3E%3C/svg%3E" />
  </head>
  <body>
    <header class="site-header">
      <div class="container">
        <div class="title-row">
          <h1>教育学学术导航</h1>
          <div class="actions">
            <button id="themeToggle" class="btn" title="切换深/浅色">🌗 主题</button>
            <button id="reviewBtn" class="btn admin-only" title="审核用户提交">🗂 审核提交</button>
            <button id="submitBtn" class="btn" title="提交网站">📝 提交网站</button>
            <button id="importBtn" class="btn admin-only" title="从本地导入JSON">⬆️ 导入</button>
            <button id="exportBtn" class="btn admin-only" title="导出当前JSON">⬇️ 导出</button>
            <button id="resetBtn" class="btn admin-only" title="移除本地数据并恢复默认">♻️ 重置</button>
            <input id="fileInput" type="file" accept="application/json" hidden />
          </div>
        </div>
        <div class="acad-row">
          <form id="acadForm" class="acad-search" action="#" target="_blank" rel="noopener">
            <label for="acadQuery" class="sr-only">学术搜索</label>
            <select id="acadProvider" aria-label="选择学术搜索引擎" title="选择学术搜索引擎">
              <option value="gscholar">Google 学术</option>
              <option value="baiduxueshu">百度学术</option>
              <option value="cnki">CNKI</option>
              <option value="eric">ERIC</option>
              <option value="semanticscholar">Semantic Scholar</option>
              <option value="jstor">JSTOR</option>
              <option value="sage">SAGE</option>
              <option value="wiley">Wiley</option>
              <option value="tandf">Taylor &amp; Francis</option>
              <option value="springer">Springer</option>
              <option value="sciencedirect">ScienceDirect</option>
            </select>
            <input id="acadQuery" type="search" placeholder="学术搜索：关键词、作者、题名…（回车搜索）" aria-label="学术搜索输入" />
            <select id="acadTime" aria-label="时间范围" title="限定时间范围（部分引擎支持）">
              <option value="">时间不限</option>
              <option value="1">近1年</option>
              <option value="3">近3年</option>
              <option value="5">近5年</option>
            </select>
            <input id="acadSite" class="site-input" type="text" inputmode="url" placeholder="限定域名（可选，如 eric.ed.gov）" title="限定某个域名进行站内搜索（在支持 site: 的搜索引擎上有效）" />
            <button id="acadGo" class="btn" type="submit" title="搜索">搜索</button>
          </form>
        </div>
        <div class="sub-row">
          <div class="search-box">
            <input id="searchInput" type="search" placeholder="搜索：名称、描述或标签" aria-label="搜索资源" />
          </div>
          <div class="meta-info">
            <span id="countInfo">—</span>
            <span class="dot">•</span>
            <span id="lastUpdated">上次更新：—</span>
          </div>
          <div class="dropdown">
            <button id="disciplineMenuBtn" class="btn btn-minor" aria-haspopup="true" aria-expanded="false" aria-controls="disciplineDropdown" title="按教育学学科筛选">📚 学科筛选</button>
            <div id="disciplineDropdown" class="dropdown-panel" hidden>
              <div class="discipline-controls">
                <select id="disciplineParent" title="选择一级学科">
                  <option value="all">全部一级学科</option>
                </select>
                <button id="disciplineClear" class="btn btn-minor" title="清空已选学科">清空</button>
              </div>
              <div id="disciplineList" class="tags"></div>
            </div>
          </div>
        </div>
        <div class="tags-wrap">
          <div class="tags-title">标签筛选：</div>
          <div id="tags" class="tags"></div>
        </div>
      </div>
    </header>

    <main class="container">
      <div id="grid" class="grid" aria-live="polite"></div>
    </main>

    <footer class="site-footer container">
      <p>
        数据存放于 <code>data/resources.json</code>。在本地可通过“导入/导出/重置”即时预览；部署到 Vercel 时只需更新该 JSON 文件即可。
      </p>
      <p class="small">拖拽 JSON 文件到页面也可导入。</p>
    </footer>

    <!-- 提交网站：右侧抽屉 -->
    <div id="submitDrawer" class="drawer" hidden>
      <div class="drawer-overlay" data-close="drawer"></div>
      <aside class="drawer-panel" role="dialog" aria-modal="true" aria-labelledby="submitTitle">
        <div class="drawer-header">
          <h2 id="submitTitle">提交网站</h2>
          <button class="btn btn-minor" id="drawerClose" title="关闭">✕</button>
        </div>
        <form id="submitForm" class="submit-form">
          <div class="form-field">
            <label for="sName">名称</label>
            <input id="sName" type="text" required placeholder="例如：ERIC" />
          </div>
          <div class="form-field">
            <label for="sUrl">链接</label>
            <input id="sUrl" type="url" required placeholder="例如：https://eric.ed.gov/" />
          </div>
          <div class="form-field">
            <label for="sDesc">简介</label>
            <textarea id="sDesc" rows="3" placeholder="一句话说明该网站的用途与亮点"></textarea>
          </div>
          <div class="form-field">
            <label for="sTags">标签（逗号分隔，可选）</label>
            <input id="sTags" type="text" placeholder="例如：文献数据库, 英文, 教育学" />
          </div>
          <div class="form-field">
            <label for="sDisc">学科代码（逗号分隔，可选）</label>
            <input id="sDisc" type="text" placeholder="例如：0401, 040110（参考学科筛选代码）" />
          </div>
          <div class="form-field">
            <label for="sContact">联系邮箱（可选）</label>
            <input id="sContact" type="email" placeholder="用于必要时联系补充信息" />
          </div>
          <div class="form-field">
            <label>验证码</label>
            <div class="captcha-row">
              <span id="capQuestion">—</span>
              <button id="capRefresh" class="btn btn-minor" type="button" title="换一个">换一个</button>
            </div>
            <input id="capAnswer" type="text" inputmode="numeric" pattern="[0-9]*" placeholder="请输入上方算式的结果" required />
          </div>
          <div class="form-actions">
            <button class="btn" type="submit">提交</button>
          </div>
          <p id="submitHint" class="small muted"></p>
        </form>
      </aside>
    </div>

    <!-- 审核提交：右侧抽屉（管理员） -->
    <div id="reviewDrawer" class="drawer" hidden>
      <div class="drawer-overlay" data-close="review"></div>
      <aside class="drawer-panel" role="dialog" aria-modal="true" aria-labelledby="reviewTitle">
        <div class="drawer-header">
          <h2 id="reviewTitle">审核提交</h2>
          <button class="btn btn-minor" id="reviewClose" title="关闭">✕</button>
        </div>
        <div class="submit-form">
          <div class="form-field">
            <label for="adminToken">管理员令牌</label>
            <input id="adminToken" type="password" placeholder="在 Vercel 环境变量中配置 ADMIN_TOKEN，并在此粘贴" />
            <div>
              <button id="saveAdminToken" class="btn" type="button">保存令牌</button>
              <button id="clearAdminToken" class="btn btn-minor" type="button">清除</button>
            </div>
          </div>
          <div class="form-field">
            <label for="reviewFilter">状态筛选</label>
            <select id="reviewFilter">
              <option value="all">全部</option>
              <option value="pending">待审核</option>
              <option value="approved">已通过</option>
              <option value="rejected">已拒绝</option>
            </select>
            <label style="display:flex;align-items:center;gap:6px;margin-top:8px;">
              <input id="reviewOnlyPending" type="checkbox" /> 仅未处理
            </label>
            <div style="display:flex;align-items:center;gap:8px;margin-top:8px;">
              <input id="reviewSearch" type="search" placeholder="搜索名称/链接/描述/标签/学科/联系" style="flex:1 1 auto; padding:8px 10px; border:1px solid var(--border); border-radius:8px; background:var(--bg); color:var(--fg);" />
              <button id="reviewDoSearch" class="btn" type="button">搜索</button>
              <button id="reviewExportCsv" class="btn btn-minor" type="button" title="导出当前列表为 CSV">导出CSV</button>
            </div>
          </div>
          <div id="reviewList" class="review-list"></div>
          <div class="form-actions">
            <button id="reviewLoadMore" class="btn" type="button">加载更多</button>
          </div>
          <p id="reviewHint" class="small muted"></p>
        </div>
      </aside>
    </div>

    <script src="js/app.js"></script>
  </body>
  </html>
